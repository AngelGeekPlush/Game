<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Angel Geek</title>
    <style>
    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        display: flex; /* Centra el canvas */
        justify-content: center;
        align-items: center;
        background: black;
        overflow: hidden;
    }
    canvas {
        display: block;
        width: 100vw;
        height: 100vh;
        background: black;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        touch-action: none; /* Previene el zoom y scroll t치ctil */
    }

 .dialog-base-style {
    /* 1. Posicionamiento en la pantalla: Centrado en la parte inferior */
    position: fixed;    /* Fija el elemento a la ventana del navegador, para que no se mueva con el scroll. */
    bottom: 0;          /* CLAVE: Lo pega al borde INFERIOR de la ventana. Si quieres un peque침o margen desde abajo, c치mbialo a '20px' o '30px'. */
    left: 50%;          /* Coloca el inicio del elemento a la mitad del ancho de la ventana. */
     transform: translate(-50%); /* CLAVE PARA EL CENTRADO HORIZONTAL: Mueve el elemento hacia la izquierda por la mitad de su propio ancho, centr치ndolo perfectamente en la pantalla. */
    
    /* 2. Tama침o General: Ocupa la mayor칤a de la parte inferior de la pantalla */
    width: 100vw;       /* OCUPA TODO EL ANCHO DE LA PANTALLA (100% del ancho del viewport). */
    /* REMOVIDO: max-width: 700px; - Si quieres que ocupe todo el ancho, no hay 'max-width'. */
    height: 40vh;       /* CLAVE: ALTURA del cuadro de di치logo, ocupando el 40% de la altura de la ventana (viewport). Puedes ajustar este valor (ej. 30vh para m치s bajo, 50vh para m치s alto) para que ocupe "la mayor칤a de la parte inferior" a tu gusto. */
    min-height: 180px;  /* Asegura que la caja siempre tenga un alto m칤nimo en p칤xeles, para que no sea ilegible en pantallas muy peque침as. */
    
    /* 3. Propiedades de la Imagen de Fondo (춰Aplicadas a ambos di치logos!) */
    background-image: url('./img/dialogue_box_background.webp'); /* La ruta a tu imagen de fondo. 춰VERIFICA QUE ESTA RUTA SEA CORRECTA! */
    background-size: 100% 100%; /* CLAVE PARA EL FONDO: La imagen se estira para CUBRIR COMPLETAMENTE el 치rea del contenedor, sin dejar espacios en blanco, pero puede cortar partes de la imagen si no coincide la proporci칩n. */
    background-repeat: no-repeat; /* La imagen de fondo no se repite. */
    background-position: center center; /* CLAVE: La imagen de fondo se centra horizontal y verticalmente dentro del contenedor. Esto deber칤a solucionar el problema de que se ve칤a "hacia abajo". Puedes probar con 'center top' o 'center bottom' si quieres un alineamiento espec칤fico. */
    overflow: hidden; /* Oculta cualquier contenido o fondo que se salga del borde de la caja. */
    
    /* 4. Estilos visuales generales (bordes, sombras, color de fondo de respaldo) */
    
    color: #fff; /* Color de texto predeterminado para toda la caja. */
    border: none; /* REMOVIDO: Ya que el cuadro se extiende de borde a borde, los bordes normales no se ven bien. */
    border-radius: 0; /* REMOVIDO: No hay bordes redondeados si ocupa toda la parte inferior. */
    box-shadow: none; /* REMOVIDO: No hay sombra si ocupa toda la parte inferior. */
    border-top-left-radius: 10px; /* OPCIONAL: Si quieres bordes redondeados solo en las esquinas superiores cuando est치 pegado al borde inferior. */
    border-top-right-radius: 10px; /* OPCIONAL */
    
    /* 5. Propiedades de texto generales (aplicadas a todo el texto dentro de la caja si no se sobrescriben) */
    font-size: 1.2em; /* Tama침o de fuente base. */
    line-height: 1.5; /* Espaciado entre l칤neas. */
    
    /* 6. Comportamiento (para JavaScript) */
    z-index: 10; /* Asegura que est칠 por encima de la mayor칤a de los elementos del juego. */
    pointer-events: none; /* Por defecto, no permite clics ni toques (JavaScript lo activar치 cuando el di치logo est칠 activo). */
    user-select: none; /* No permite seleccionar texto dentro de la caja. */
    animation: fadeIn 0.3s ease-out forwards; /* Tu animaci칩n de aparici칩n. */
    display: none; /* OCULTO POR DEFECTO: JavaScript controlar치 cu치ndo mostrarlo ('flex'). */
    box-sizing: border-box; /* Crucial para que el 'padding' y 'border' se incluyan DENTRO del 'width' y 'height' del elemento. */
}

/* Modificaci칩n de la animaci칩n fadeIn: vuelve a su comportamiento anterior con transform */
/* Esto se mantiene para que la caja aparezca desliz치ndose desde abajo. */
@keyframes fadeIn {
    from { opacity: 0; transform: translateX(-50%) translateY(20px); }
    to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

   #textBoxContainer {
  /* REMOVIDAS: position, bottom, left, transform, width, max-width, height, min-height, max-height,
                 background-size, background-position, background-repeat, border-radius.
                 TODAS estas propiedades ya las hereda de .dialog-base-style.
    */
     
   
   
    padding: 2vh 3vw; /* AJUSTADO: Relleno interno para dar espacio al contenido.
                          Usamos 'vh' y 'vw' para que sea responsivo al tama침o de la pantalla.
                          Ajusta estos valores si quieres m치s o menos espacio. */
    box-sizing: border-box;
    display: flex;       /* CLAVE: Activa Flexbox para organizar sus hijos (imagen y texto). */
    flex-direction: row; /* CLAVE: Los elementos (imagen y texto) ir치n uno al lado del otro, en una fila. */
    align-items: center; /* Centra verticalmente la imagen y el texto dentro de la fila. */
    justify-content: center; /* Centra horizontalmente el grupo de imagen + texto dentro de la caja. */
    text-align: center;  /* Esto alinea el texto si no hay un <div> espec칤fico para el texto. */
    box-sizing: border-box; /* Asegura que el padding se incluya en el tama침o total. */
   
}

#dialogueItemImage {
    /* No repetimos position, top, left, transform, etc.;
       su posicionamiento es manejado por el Flexbox de su padre (#textBoxContainer) y el padding de este. */
    
    /* Tama침o responsivo para la imagen del 칤tem:
       clamp(valor_minimo, tama침o_preferido, valor_maximo)
       Ej: 100px m칤nimo, 15% del ancho del viewport preferido, 200px m치ximo.
       AJUSTADO: Valores m치s razonables para que la imagen se vea bien y deje espacio. */
    width: clamp(100px, 15vw, 200px); /* El ancho de la imagen */
    height: clamp(100px, 15vw, 200px); /* El alto de la imagen (mantener igual al ancho para proporci칩n cuadrada) */
    
    margin-right: 30px; /* CLAVE: Espacio a la derecha de la imagen, para separarla del texto. Ajusta este valor. */
    
    object-fit: contain; /* La imagen se ajusta dentro de su espacio sin cortarse, manteniendo su proporci칩n. */
    display: none; /* Oculto por defecto: JavaScript lo har치 'block' cuando el di치logo de 칤tem est칠 activo. */
    z-index: 12; /* Asegura que la imagen est칠 por encima de la imagen de fondo de la caja de di치logo. */
    border-radius: 8px; /* Bordes redondeados para la imagen. */
    image-rendering: pixelated; /* Si tus im치genes son pixel art, esto las mantiene n칤tidas. */
    animation: itemImagePopIn 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards; /* Tu animaci칩n de aparici칩n. */
}

/* Mant칠n tu @keyframes itemImagePopIn si ya lo tienes. Si no, aseg칰rate de que est칠. */
@keyframes itemImagePopIn {
    from { transform: scale(0.5); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

   
 @media (max-width: 700px) {
       #textBoxContainer {
                height: 30vh; /* Ajusta este valor seg칰n necesites */
                background-size: 100% 100%;
                flex-direction: row;
                padding: 10px;
            }
            #dialogueItemImage {
               
            }
            #textContent {
                font-size: clamp(4px, 3.5vw, 16px);
                padding: 1vh 1vw;
                width: 100%;
                box-sizing: border-box;
                text-align: left; /* Alineado a la izquierda */
                line-height: 1;
                max-width: calc(100% - 70px); /* Ajuste: Ancho total - (ancho m치x imagen + margen) */
            }
            #dismissPrompt {
                font-size: clamp(6px, 1.2vw, 10px); 
            }
            .dialog-base-style {
                width: 95%;
                font-size: 1em;
             }
            #generalMessageBoxContainer {
                padding: 15px 20px;
            }
            #generalMessageContent {
                font-size: 1em;
            }
            #generalDismissPrompt {
                font-size: 0.8em;
            }
    }
 
    #textBoxBackground {
        display: none; /* Asegura que el <img> no se vea si a칰n existe en HTML */
    }
 #textContent {
   /* Color de texto. Aseg칰rate de que este color sea visible sobre tu imagen de fondo. */
    color: #21190e; /* Considera cambiar a un color claro como #E0FFFF o #FFFFFF si el fondo es oscuro */
    
    /* Tama침o de fuente responsivo: AJUSTADO para que sea m치s grande y legible en una caja grande. */
    font-size: clamp(24px, 4vw, 48px);
    
    padding: 0 1vw; /* AJUSTADO: Relleno interno para el texto. Eliminamos padding-top/bottom aqu칤 ya que el padding del padre y line-height lo manejan. */
    line-height: 1.3; /* Espaciado entre l칤neas para mejor legibilidad. */
    font-family: 'Press Start 2P', Arial, sans-serif; /* Tu fuente de juego. */
    text-align: left; /* CLAVE: Alinea el texto a la izquierda *dentro de su propio bloque*, lo que hace que fluya a la derecha de la imagen. */
    pointer-events: none; /* Asegura que el texto no intercepte clics (los maneja el padre). */
    z-index: 11; /* Asegura que est칠 por encima del fondo. */
    width: 100%; /* Permite que el texto use todo el ancho que Flexbox le asigne. */
    white-space: normal; /* Permite que el texto salte de l칤nea normalmente. */
    overflow: hidden; /* Oculta el contenido que se desborda. */
    text-overflow: clip; /* No muestra '...' si el texto se corta. */
    box-sizing: border-box; /* Incluye padding y border en el tama침o total. */
    
    margin-top: 0;    /* REMOVIDO: No necesitamos margen superior, Flexbox y padding del padre lo controlan. */
    padding-top: 0;   /* REMOVIDO: Ya que el padding se maneja con el padding de la caja. */
    
    /* CLAVE: Define el ANCHO M츼XIMO que el texto puede ocupar.
       100% (ancho del contenedor flexible) - (ancho m치x de la imagen + margen derecho de la imagen + un poco de espacio extra).
       Ej: 200px (ancho m치ximo de imagen) + 30px (margen derecho) = 230px. A침adimos 20px extra para seguridad. Total: 250px.
       max-width: calc(100% - 250px);
    */
    max-width: calc(100% - 250px); /* AJUSTADO: Ancho m치ximo para el texto, deja espacio para la imagen. */
    
    flex-grow: 1; /* CLAVE: Permite que el texto ocupe todo el espacio restante en la fila. */
}

   #dismissPrompt {
    position: absolute; /* CLAVE: Permite posicionar este elemento de forma precisa dentro de su padre (#textBoxContainer). */
    bottom: 3vh;      /* AJUSTADO: Distancia desde el borde INFERIOR del cuadro de di치logo. Usamos 'vh' para que sea responsivo. Ajusta '3vh' si lo quieres m치s arriba o m치s abajo. */
    left: 50%;        /* Coloca el inicio del elemento a la mitad del ancho del padre. */
    transform: translateX(-50%); /* CLAVE: Mueve el elemento hacia la izquierda por la mitad de su propio ancho, centr치ndolo perfectamente en la parte inferior. */
    
    color: #E0FFFF; /* AJUSTADO: Color de texto claro. Aseg칰rate de que este color contraste bien con el fondo en la parte inferior de tu imagen de fondo. Si tu fondo es claro abajo, prueba un color oscuro como #21190e. */
    font-size: clamp(14px, 2vw, 24px); /* AJUSTADO: Tama침o de fuente responsivo, m치s grande para pantalla completa. */
    pointer-events: none; /* Asegura que el mensaje no intercepte clics directamente (los eventos de cierre los maneja el padre). */
    z-index: 11; /* Asegura que est칠 por encima del texto principal y la imagen de fondo. */
    font-family: 'Press Start 2P', Arial, sans-serif; /* Consistencia de fuente. */
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5); /* Sombra para el texto, mejora la visibilidad sobre fondos complejos. */
}

 @keyframes pulse {
    from { opacity: 0.7; }
    to { opacity: 1; }
}

#generalMessageBoxContainer {

    position: fixed; /* Mantiene la posici칩n relativa al viewport */
    height: 60vh; /* Altura para PC, ser치 anulada por la media query para m칩vil */
    width: 100%;  
    font-size: clamp(4px, 3.5vw, 16px); /* AJUSTA: min a 8px (o menos), preferred a 2.8vw */
    padding: 1vh 1vw; /* Relleno ajustado para m칩vil */
           /* max-width: 100%;  Ancho m치ximo ajustado para m칩vil */
    box-sizing: border-box; /* 游대 Incluye el padding dentro del width */
    text-align: center;
    overflow: visible;
    text-overflow: clip;
    font-size: 1.2em; /* Tu tama침o de fuente */
    line-height: 1.5; /* Tu altura de l칤nea */
    font-family: 'Press Start 2P', Arial, sans-serif; 
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
    padding: 15px; /* AJUSTADO: Un padding m치s compacto para el dise침o flexbox */
    background-size: 100% 100%; /* CLAVE PARA EL FONDO: La imagen se estira para CUBRIR COMPLETAMENTE el 치rea del contenedor, sin dejar espacios en blanco, pero puede cortar partes de la imagen si no coincide la proporci칩n. */
    background-repeat: no-repeat; /* La imagen de fondo no se repite. */
    background-position: center center; /* CLAVE: La imagen de fondo se centra horizontal y verticalmente dentro del contenedor. Esto deber칤a solucionar el problema de que se ve칤a "hacia abajo". Puedes probar con 'center top' o 'center bottom' si quieres un alineamiento espec칤fico. */
    overflow: hidden; /* Oculta cualquier contenido o fondo que se salga del borde de la caja. */
    justify-content: flex-start;
    align-items: center;
    border-radius: 0;

}

/* Estilos para el TEXTO general dentro de #generalMessageBoxContainer (#generalMessageContent) */
#generalMessageContent {
    font-size: clamp(18px, 3.5vw, 36px);
    color: #21190e;
    line-height: 1.2;
    text-align: center;
    margin: 0 auto;
    max-width: 90%;
        }
/* Estilos para el MENSAJE DE CIERRE general (#generalDismissPrompt) */
 #generalDismissPrompt {
           font-size: clamp(10px, 2vw, 18px);
    margin-top: 1vh;
    color: #99ffff;
    text-align: center;
    animation: pulse 1.5s infinite alternate;
        }

    #inventoryPanel {
        position: fixed; /* Lo fija en la pantalla */
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%); /* Centra el panel en la pantalla */
        width: 80vw; /* Ancho del 80% del viewport */
        height: 70vh; /* Alto del 70% del viewport */
        max-width: 500px; /* Ancho m치ximo para pantallas grandes */
        max-height: 700px; /* Alto m치ximo para pantallas grandes */
        background-color: rgba(30, 30, 30, 0.95); /* Fondo oscuro semitransparente */
        border: 2px solid #663399; /* Borde morado para estilo RPG */
        border-radius: 15px; /* Bordes redondeados */
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.7); /* Sombra suave */
        color: white;
        font-family: 'Press Start 2P', Arial, sans-serif;
        padding: 20px;
        display: none; /* 춰Oculto por defecto! JavaScript lo mostrar치 */
        flex-direction: column; /* Organiza el contenido verticalmente */
        justify-content: flex-start; /* Alinea el contenido al inicio */
        align-items: center; /* Centra el contenido horizontalmente */
        z-index: 100; /* Asegura que est칠 por encima de todo lo dem치s */
        overflow-y: auto; /* Permite desplazamiento vertical si hay muchos 칤tems */
    }

    #inventoryTitle {
        font-size: clamp(20px, 4vw, 36px); /* T칤tulo responsivo */
        color: #FFD700; /* Color dorado para el t칤tulo */
        margin-bottom: 20px;
        text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5); /* Sombra para el texto */
    }

    #inventoryList {
        list-style: none; /* Elimina los puntos de la lista */
        padding: 0;
        margin: 0;
        width: 90%; /* Ancho de la lista dentro del panel */
        flex-grow: 1; /* Permite que la lista ocupe el espacio disponible */
        text-align: center; /* Centra el texto de los 칤tems */
    }

    .inventory-item {
        display: flex; /* Para alinear el icono y el texto */
        align-items: center; /* Centra verticalmente el icono y el texto */
        justify-content: center; /* Centra horizontalmente el 칤tem completo */
        font-size: clamp(14px, 2.5vw, 24px); /* Tama침o del texto del 칤tem responsivo */
        padding: 8px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2); /* L칤nea divisoria */
        text-transform: capitalize; /* Capitaliza la primera letra */
    }

    .inventory-item:last-child {
        border-bottom: none; /* No hay l칤nea en el 칰ltimo 칤tem */
    }

    .inventory-item-icon {
        width: 32px; /* Tama침o del icono */
        height: 32px;
        margin-right: 10px; /* Espacio entre icono y texto */
        image-rendering: pixelated; /* Si tus iconos son pixel art */
    }

    #closeInventoryButton {
        background-color: #A0522D; /* Color marr칩n para el bot칩n */
        color: white;
        font-family: 'Press Start 2P', Arial, sans-serif;
        font-size: clamp(12px, 2vw, 20px);
        padding: 10px 20px;
        border: 2px solid #CD853F; /* Borde m치s claro */
        border-radius: 8px;
        cursor: pointer;
        margin-top: 20px;
        box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.4);
        transition: background-color 0.2s ease, transform 0.1s ease;
    }

    #closeInventoryButton:hover {
        background-color: #CD853F;
        transform: translateY(-2px); /* Efecto al pasar el rat칩n */
    }

    #closeInventoryButton:active {
        background-color: #8B4513;
        transform: translateY(0); /* Efecto al presionar */
    }

    /* Media query para m칩viles: ajustar tama침o del panel si es necesario */
    @media (max-width: 600px) {
        #inventoryPanel {
            width: 95vw; /* M치s ancho en m칩vil */
            height: 80vh; /* M치s alto en m칩vil */
            padding: 10px;
        }
        #inventoryTitle {
            margin-bottom: 10px;
        }
        #closeInventoryButton {
            margin-top: 10px;
            padding: 8px 15px;
        }
    }

    #dialogueItemImage {
    /* REMOVIDAS: position: absolute, top, left, transform */
    /* Estas propiedades ya no son necesarias porque est치 dentro de un flexbox */
    width: 25vw; /* TAMA칌O FIJO para la imagen (ajusta estos valores) */
    height: 50vh; /* TAMA칌O FIJO */
    /* min-width: 200px; /* Tama침o m칤nimo para asegurar visibilidad en m칩viles */
    /*  min-height: 280px;*/
    max-width: 25vw; /* L칤mite para que no crezca demasiado en pantallas grandes */
    max-height: 50vh;
    margin-left: 10px;
    margin-top: 80px;
    margin-right: 10px; /* CLAVE: Espacio a la derecha de la imagen para separarla del texto */
    object-fit: fill; /* Asegura que la imagen se ajuste sin recortarse */
    display: none; /* Oculto por defecto, JavaScript lo mostrar치 */
    z-index: 12;
    border-radius: 8px; /* Tus bordes redondeados */
    image-rendering: pixelated; /* Si tus iconos son pixel art */
    animation: itemImagePopIn 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards; /* Tu animaci칩n */
}
</style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>

<!-- 춰ESTRUCTURA HTML CORREGIDA PARA LOS DI츼LOGOS! -->
<!-- Ambos contenedores de di치logo son ahora HERMANOS directos del <body>, NO ANIDADOS.
     Ambos tendr치n la clase 'dialog-base-style' para los estilos comunes. -->

<!-- Contenedor para el DI츼LOGO DE 칈TEMS (Tu #textBoxContainer existente) -->
<div id="textBoxContainer" class="dialog-base-style" style="display: none;">
    <img id="dialogueItemImage" src="" alt="Item" style="display: none;">
    <div id="textContent"></div>
    <div id="dismissPrompt">.</div>
</div>

<!-- Contenedor para el DI츼LOGO GENERAL (Tu nuevo #generalMessageBoxContainer) -->
<div id="generalMessageBoxContainer" class="dialog-base-style" style="display: none;">
    <div id="generalMessageContent"></div>
    <div id="generalDismissPrompt">.</div>
</div>

<!-- El panel de inventario y el script del juego deben ir DESPU칄S de estos dos divs de di치logo -->
<div id="inventoryPanel">
    <h2 id="inventoryTitle">Inventario</h2>
    <ul id="inventoryList">
        <!-- Los 칤tems se insertar치n aqu칤 con JavaScript -->
    </ul>
    <button id="closeInventoryButton">Cerrar</button>
</div>

<script type="module" src="./js/game.js?v=74"></script>
</body>
</html>
